% !Mode:: "TeX:UTF-8"

\BiChapter{非平衡扩散极限下一维灰度辐射流体力学方程组的求解方法}{One dimensional radiation hydrodynamics model
in the grey nonequilibrium-diffusion limit}
本章将对非平衡扩散极限下一维灰度辐射流体力学方程组进行数值求解。首先介绍了非平衡扩散极限下一维灰度辐射流体力学模型和该模型的性质；其次给出了对于该模型的算法设计，将~MUSCL-Hancock 算法应用到辐射和流体耦合的双曲系统，使用中心型有限体积格式求解该模型的扩散部分；最后通过数值实验与辐射激波解的理论一致验证该算法的有效性。

\BiSection{非平衡扩散极限下一维灰度辐射流体力学模型}{One dimensional radiation hydrodynamics model
in the grey nonequilibrium-diffusion limit}
在非平衡扩散极限下的灰度辐射流体力学模型中，流体的温度不等于辐射温度。假定一个单介质是辐射不透明的，在非平衡扩散极限下，非相对论的灰度辐射流体力学方程组
可写作~\cite{2008Radiative}，
\begin{equation}\label{nonequilibrium_model}
\left\{
\begin{array}{llll}
\partial_t&\rho+\partial_x(\rho {u})=0,\vspace{1ex}\\
 \partial_t&(\rho {u})+\partial_x(\rho {u}^2+p+\frac{1}{3}\mathcal{P}_0E_r)=0,\vspace{1ex}\\
 \partial_t&(\rho E)+\partial_x((\rho E +p){u})=-\mathcal{P}_0S_e,\vspace{1ex}\\
 \partial_t&({E_r})+\frac{4}{3}\partial_x(uE_r)-\partial_x(\kappa(\rho,T)\partial_xE_r)=S_e,\vspace{1ex}
\end{array}
\right.
\end{equation}
其中~$E=e+\frac{1}{2}u^2$，$E_r=T_r^4$, $S_e$ 表示物质能量与辐射能量的转换，可以写作为
\begin{equation}\label{nonequilibrium_model_S_e}
S_e=\sigma(T^4-E_r)+\frac{1}{3}u\partial_x{E_r}.
\end{equation}
这里~$\rho$, ${u}$, $p$, $e=C_vT$, $C_v$, $T$, $T_r$, $\kappa(\rho,T)$ 和~$\sigma$
分别表示密度，速度，压力，比内能，等容比热系数，物质温度，辐射温度，非线性的热扩散，吸收截面积，
$\mathcal{P}_0$ 是辐射常数，反应了辐射对流体的影响，约等于辐射能量与物质能量的比值。
系统~(\ref{nonequilibrium_model}) 分别表示质量守恒、动量守恒、能量守恒和辐射能量守恒；
方程~(\ref{nonequilibrium_model_S_e}) 右端中第一项表示辐射的吸收与释放，第二项是与辐射压力对物质的做功有关。

由系统~(\ref{nonequilibrium_model}) 可以得到几个重要的关系式。
将系统~(\ref{nonequilibrium_model}) 中第三个方程与~$\mathcal{P}_0$ 乘以第四个方程的和可以得到总的能量守恒公式，
\begin{equation}\label{nonequilibrium_model_total_energy}
\partial_t(\rho E+\mathcal{P}_0E_r)+\partial_x[u(\rho E+p+\frac{4}{3}\mathcal{P}_0E_r)]=\mathcal{P}_0\partial_x(\kappa(\rho,T)\partial_x E_r).
\end{equation}
由系统~(\ref{nonequilibrium_model}) 中第四个方程，可以得到
\begin{equation}\label{nonequilibrium_model_entropy}
\partial_t S_r +\partial_x(S_ru)=\frac{3}{4T_r}[\partial_x(\kappa(\rho,T)\partial_x E_r)+\sigma(T^4-E_r)],
\end{equation}
这里~$S_r=T_r^3$ 是辐射熵~\cite{buet2006asymptotic}。
因此，将系统~(\ref{nonequilibrium_model}) 改写为下面的形式，
\begin{equation}\label{nonequilibrium_model_rewrite}
\left\{
\begin{array}{llll}
 \partial_t&\rho+\partial_x(\rho {u})=0,\vspace{1ex}\\
 \partial_t&(\rho {u})+\partial_x(\rho {u}^2+p^*)=0,\vspace{1ex}\\
 \partial_t&(\rho E^*)+\partial_x((\rho E^* +p^*){u})=\mathcal{P}_0\partial_x(\kappa(\rho,T)\partial_x E_r),\vspace{1ex}\\
 \partial_t&({S_r})+\partial_x(uS_r)=\frac{3}{4T_r}(\partial_x(\kappa(\rho,T)\partial_xE_r)+\sigma(T^4-E_r)).\vspace{1ex}
\end{array}
\right.
\end{equation}
这里有总压力~$p^*=p+\frac{1}{3}\mathcal{P}_0T_r^4$，总能量~$\rho E^*=\rho E+\mathcal{P}_0 E_r$。$\frac{1}{3}\mathcal{P}_0T_r^4$，$\mathcal{P}_0T_r^4$ 分别表示辐射压力和辐射能量。为了封闭辐射流体力学模型~(\ref{nonequilibrium_model_rewrite})，需要引入状态方程，
\begin{equation*}\label{EOS}
p=p(\rho,e).
\end{equation*}
在这篇文章中，只考虑理想气体的状态方程，
\begin{equation*}\label{prefect_gas_EOS3}
\begin{array}{ll}
p=(\gamma-1)\rho e,\vspace{1ex}\\
e=\frac{T}{\gamma(\gamma-1)},
\end{array}
\end{equation*}
这里~$\gamma$ 是比热率。
该状态方程满足热力学关系式，
\begin{equation*}\label{gibbs}
TdS=de-\frac{p^*}{\rho^2}d\rho,
\end{equation*}
其中~$T$ 表示温度，$S$ 表示熵。

\BiSection{模型的数学性质}{The nature of the model}
\BiSubsection{非平衡扩散极限下灰度辐射模型激波结构的概述}{Summary of the shock wave structure of the radiation model in the grey nonequilibrium diffusion limit}
对于常见的流体运动模型，如果忽略粘性，穿过激波，流体变量均是间断的。然而，对于辐射流体力学系统来说，穿过激波辐射强度是连续的，流体变量穿过激波可能是连续的也可能是间断的。

对于非平衡扩散下的灰度辐射流体系统~(\ref{nonequilibrium_model_rewrite})，由于系统~(\ref{nonequilibrium_model_rewrite}) 中辐射扩散项的影响，该模型中的辐射温度~$T_r$ 一定是连续的，而物质温度~$T$ 可能是连续的也可能不是连续的。一个微粒穿过非平衡扩散下的灰度辐射流体力学模型的激波时，将可能依次穿过辐射前导区域~(Radiative precursor)、 流体激波部分~(Hydrodynamic shock) 和耗散区域~(Relaxation regions)~\cite{lowrie2007radiative}，如图~\ref{FIGG23} 和图~\ref{FIGG22} 所示，其中辐射前导区域是由激波后物质的热辐射产生的，在该区域中，流体的温度从~$T_0$ 上升到温度~$T_p$。~$T_p$ 的温度决定了辐射激波的类型：如果~$T_p<T_1$，该辐射激波是亚临界辐射激波，如图~\ref{FIGG23} 所示；如果~$T_p=T_1$，则该辐射激波是超临界辐射激波，如图~\ref{FIGG22} 所示。穿过辐射前导区域后，微粒将会进入流体激波部分，物质的温度将从~$T_p$ 加热到~$T_s$。到~$T_s$ 的飞跃称作是~Zel'dovich 飞跃。接下来，微粒将会进入耗散区域。经过该区域，物质的温度将会下降直到等于辐射温度。

然而，不是每一个辐射激波都会有这些特征。非平衡扩散极限下的辐射流体力学模型的灰度辐射激波性质依赖于~$\mathcal{P}_0$，$\kappa(\rho,T)$，$\sigma$ 和激波马赫数~$\mathcal{M}_0$ 这四个因素
~\cite{2008Radiative}。在文献~\cite{2008Radiative}，Lowrie、Edwards 等人阐述了等温的声速点~(ISP)，该声速点的存在将会决定~Zel'dovich 飞跃的产生。并且对于非平衡扩散极限下的灰度辐射流体力学模型激波结构来说，最主要的两个特征就是：是否有流体激波嵌入、是否存在等温的声速点~($\mathcal{M}_{ISP}=\frac{1}{\sqrt{\gamma}}$)，更详细的细节可以参看文献
\cite{2008Radiative}。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.8\textwidth]{\fpath FIGG23}
\caption{亚临界辐射激波的例子}\label{FIGG23}\vspace{-1em}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=0.8\textwidth]{\fpath FIGG22}
\bicaption[FIGG22]{}{超临界辐射激波的例子}{Fig.$\!$}{Example of the radiative supercritical shock profile}\vspace{-1em}
\end{figure}

\BiSubsection{非平衡扩散极限下灰度辐射流体力学模型双曲系统的性质}{The nature of the hyperbolic system the radiation model in the grey nonequilibrium diffusion limit}
将非平衡扩散的灰度辐射模型系统~(\ref{nonequilibrium_model}) 分裂成一个守恒律的双曲部分和一个非线性的辐射热扩散部分：
\begin{equation}\label{nonequilibrium_hyperbolic}
\left\{
\begin{array}{llll}
 \partial_t&\rho+\partial_x(\rho {u})=0,\vspace{1ex}\\
 \partial_t&(\rho {u})+\partial_x(\rho {u}^2+p^*)=0,\vspace{1ex}\\
 \partial_t&(\rho E^*)+\partial_x((\rho E^* +p^*){u})=0,\vspace{1ex}\\
 \partial_t&({S_r})+\partial_x(uS_r)=0,\vspace{1ex}
\end{array}
\right.
\end{equation}
和
\begin{equation}\label{nonequilibrium_heat_transfer}
\left\{
\begin{array}{llll}
  \partial_t&\rho=0,\vspace{1ex} \\
 \partial_t&(\rho {u})=0,\vspace{1ex}\\
 \partial_t&(\rho E^*)=\mathcal{P}_0\partial_x(\kappa(\rho,T)\partial_x E_r),\vspace{1ex}\\
 \partial_t&({S_r})=\frac{3}{4T_r}(\partial_x(\kappa(\rho,T) \partial_xE_r)+\sigma(T^4-E_r)).\vspace{1ex}
\end{array}
\right.
\end{equation}
考虑该模型的双曲部分~(\ref{nonequilibrium_hyperbolic})，可以将该系统写成拟线性的形式
\begin{equation}\label{nonequilibrium_hyperbolic_quasilinear}
\mathbf{W}_t+\mathbf{A}(\mathbf{W})\mathbf{W}_x=0,
\end{equation}
其中
\begin{equation*}\label{nonequilibrium_hyperbolic_A_W}
\mathbf{A}(\mathbf{W})=
\begin{pmatrix}
 u & \rho & 0 & 0\\
 0 & u    & \frac{1}{\rho} &0\\
 0 & \rho a_r^2 &u &0\\
 0 & S_r & 0 &u\\
\end{pmatrix},\\
\end{equation*}
这里~$a_r:=\sqrt{(\frac{\partial p^*}{\partial \rho})_S}$ 是声速， $\mathbf{W}=(\rho,u,p*,S_r)$ 是原始变量。
%并且满足热力学关系
%\begin{equation}\label{nonequilibrium_thermo_relation}
%TdS=de-\frac{p^*}{\rho^2}d\rho,
%\end{equation}
%其中~$S$ 是热力学变量熵。
声速可以由下面公式给出，
\begin{equation}\label{nonequilibrium_sound_speed}
a_r=\sqrt{\frac{\gamma p}{\rho}+\mathcal{P}_0\frac{4E_r}{9\rho}}.
\end{equation}
对于雅可比矩阵~$\mathbf{A}(\mathbf{W})$，计算可得其四个特征值为
\begin{equation*}\label{nonequilibrium_eigenvalues}
\lambda_1=u-a_r,~~~\lambda_2=\lambda_3=u,~~~\lambda_4=u+a_r.
\end{equation*}
并进一步得到，其对应的右特征向量为
\begin{equation*}\label{nonequilibrium_eigenvectors1}
\mathbf{R}_1=
\begin{pmatrix}
 1\\
 -\frac{a_r}{\rho}\\
 a_r^2\\
 \frac{S_r}{\rho}\\
\end{pmatrix},~
\mathbf{R}_2=
\begin{pmatrix}
 1\\
 0\\
 0\\
 0\\
\end{pmatrix},~
\mathbf{R}_3=
\begin{pmatrix}
 0\\
 0\\
 0\\
 1\\
\end{pmatrix},~
\mathbf{R}_4=
\begin{pmatrix}
 1\\
 \frac{a_r}{\rho}\\
 a_r^2\\
 \frac{S_r}{\rho}\\
\end{pmatrix}.\\
\end{equation*}
\BiSection{算法设计}{Algorithm design}
在辐射流体力学模型的计算中，为了能够克服辐射源项刚性带来的计算难点，采用算子分裂的算法进行计算。将辐射流体力学模型~(\ref{nonequilibrium_model}) 分解为一个辐射场和流体耦合的守恒律双曲系统和一个非线性的辐射扩散系统。对于辐射模型的双曲部分，将采用~MUSCL-Hancock 算法。由于辐射场中，光子运动以光速传播，而物质运动是声速，显式格式的时间步长将会受到算法稳定性的限制，因此将采用隐式有限体积格式求解辐射热传导部分。

首先，介绍~MUSCL-Hancock 算法应用到非平衡扩散极限下灰度辐射流体力学模型的双曲系统~(\ref{nonequilibrium_hyperbolic})。然后使用中心型有限体积方法求解该模型的扩散部分~(\ref{nonequilibrium_heat_transfer})。

\BiSubsection{求解非平衡扩散极限下灰度辐射流体模型双曲系统的~MUSCL-Hancock方法}{MUSCL-Hancock method for solving hyperbolic system of radiation fluid model in grey nonequilibrium diffusion limit}
本节，将~MUSCL-Hancock 方法应用到非平衡扩散极限下灰度辐射流体力学模型的双曲系统~(\ref{nonequilibrium_hyperbolic}) 中。将计算域~$[0,x_{\max}]$ 划分为均匀的网格~$\{x_j=j\Delta x, ~j=0,1,2,3,\cdots\}$。
其中第~$j$ 个网格被定义为~$I_{j}=[x_{j-\frac{1}{2}},x_{j+\frac{1}{2}}]$, 这里~$x_{j+\frac{1}{2}}=\frac{(x_j+x_{j+1})}{2}$.
对于双曲系统~(\ref{nonequilibrium_hyperbolic})，可以得到其显式、完全守恒的格式
\begin{equation}\label{nonequilibrium_conservation_scheme}
\mathbf{U}^{n+1}_{j}=\mathbf{U}^n_{j}+\frac{\Delta t}{\Delta x}(F(\mathbf{U}^{n+\frac{1}{2}}_{j-\frac{1}{2}})-F(\mathbf{U}^{n+\frac{1}{2}}_{j+\frac{1}{2}})),
\end{equation}
其中~$U_{j+\frac{1}{2}}^{n+\frac{1}{2}}$ 是变量~$U$ 在网格界面~$x=x_{j+\frac{1}{2}}$上$[t_n,t_{n+1}]$ 时间段中点的值。
对于系统~(\ref{nonequilibrium_hyperbolic})，守恒变量和通量分别为
\begin{equation*}\label{nonequilibrium_hyperbolic_variable}
U=
\begin{pmatrix}
 \rho\\
 \rho{u}\\
 \rho{E^*}\\
 {S_r}\\
\end{pmatrix}
,
~~~
F(U)=
\begin{pmatrix}
 \rho {u}\\
 \rho {{u}}^2+p^*\\
 (\rho {E}^* +p^*){{u}}\\
 {S_r}{u}\\
\end{pmatrix}.
\end{equation*}
时间步长~$\Delta t$ 定义为
\begin{equation}\label{nonequilibrium_hyperbolic_timestep}
\Delta t =\frac{C_{cfl}\Delta x}{S^n_{\max}},
\end{equation}
其中~$C_{cfl}$ 是~CFL 数，$S^n_{\max}:=\max\{|u^n_j|+{a_r}^n_j\}$ 在时刻~$t^n$ 区域内最大的波速。
对于边界，本章采用穿透边界条件~(\ref{equilibrium_hyperbolic_boundary_conditions})。
%\begin{equation}\label{nonequilibrium_hyperbolic_boundary_conditions}
%\left\{
%\begin{array}{ll}
%\mathbf{W}^n_0=\mathbf{W}^n_1,~~~~~~~~\mathbf{W}^n_{-1}=\mathbf{W}^n_2;\\
%\mathbf{W}^n_{M+1}=\mathbf{W}^n_M,~~~\mathbf{W}^n_{M+2}=\mathbf{W}^n_{M-1}.\\
%\end{array}
%\right.
%\end{equation}
%---------------------------------------------
%为了能够估计通量函数~$F(\mathbf{U}^{n+\frac{1}{2}}_{j+\frac{1}{2}})$，将修正的~HLLC 通量解法器应用到该模型~(\ref{nonequilibrium_hyperbolic}) 中。值得注意的是，该修正的~HLLC 通量解法器不同于前一章节所介绍的方法。
%对于模型~(\ref{nonequilibrium_hyperbolic})，两波的中间状态可以由
%\begin{equation}\label{nonequilibrium_hyperbolic_intermediate_state}
%{U_*}_K=\rho_K\left(\frac{S_K-u_K}{S_K-S_*}\right)
%\begin{pmatrix}
% 1\\
% S_*\\
% \frac{E_K}{\rho_K}+(S_K-u_K)\left[S_*+\frac{p_K}{\rho_K*(S_K-u_K)}\right]\\
% \frac{{{S_r}_K}}{\rho_K}\\
%\end{pmatrix}
%\end{equation}
%给定，这里~$K=L$，$K=R$。
%与此同时，可以通过
%\begin{equation}\label{nonequilibrium_hyperbolic_intermediate_fluxes}
%{F_*}_K=F_K+S_K({U_*}_K-U_K),
%\end{equation}
%给出中间状态的通量，
%其中~$S_L$, $S_R$ 和~$S_*$ 分别是最慢、最快和中间的波速。
%通过~Roe 平均特征值得到~$S_L$, $S_R$，并且
%\begin{equation}\label{3.3.11}
%S_*=\frac{p_R^*-p_L^*+\rho_L u_L (S_L-u_L)-\rho_R u_R (S_R-u_R)}{\rho_L(S_L-u_L)-\rho_R(S_R-u_R)}.
%\end{equation}

对于该辐射流体力学模型双曲系统~(\ref{nonequilibrium_hyperbolic}) 的~MUSCL-Hancock 方法与上一章的方法相同。首先
由上章中的公式~(\ref{equilibrium_hyperbolic_u+}), (\ref{equilibrium_hyperbolic_u-}), (\ref{equilibrium_hyperbolic_half_timestep1}) 和~(\ref{equilibrium_hyperbolic_half_timestep2}) 得到
半个时间步~$\frac{\triangle t}{2}$ 上~$\mathbf{U}^{n+\frac{1}{2},+}_{j-\frac{1}{2}}$, $\mathbf{U}^{n+\frac{1}{2},-}_{j+\frac{1}{2}}$ 的值。
%\textbf{第一步}：给定分片初值，$\mathbf{U}_j(x)$ 在网格~$I_j$ 端点的值为
%    $\mathbf{U}^{n,+}_{j-\frac{1}{2}}=\mathbf{U}^n_j-\frac{\triangle x}{2}\Delta_j$，$\mathbf{U}^{n,-}_{j+\frac{1}{2}}=\mathbf{U}^n_j+\frac{\triangle x}{2}\Delta_j$，斜率~$\Delta_j$ 可通过~minmod 限制器算法得到,
% \begin{equation}\label{nonequilibrium_hyperbolic_minmod}
%\Delta_j=minmod(\theta\frac{\mathbf{U}^{n}_j-\mathbf{U}^{n}_{j-1}}{\triangle x},\frac{\mathbf{U}^{n}_{j+1}-\mathbf{U}^{n}_{j-1}}{2\triangle x},\theta\frac{\mathbf{U}^{n}_{j+1}-\mathbf{U}^{n}_{j}}{\triangle x}),
%\end{equation}
%这里，参数~$\theta\in[1,2)$。%其中~midmod 非线性限制器的定义为，
%\begin{equation}
%midmod(x_1,x_2,\cdots)=\left\{
%    \begin{array}{lll}
%min_j\{x_j\},~~~if~x_j>0~~\forall j,\vspace{1ex}\\
%max_j\{x_j\},~~~if~x_j<0~~\forall j,\vspace{1ex}\\
%0,~~~otherwise.\vspace{1ex}\\
%    \end{array}
%    \right.
%    \end{equation}
%\textbf{第二步}：通过
%\begin{equation}\label{nonequilibrium_hyperbolic_half_timestep1}
%{{\mathbf{U}}}^{n+\frac{1}{2},+}_{j-\frac{1}{2}}=\mathbf{U}^{n,+}_{j-\frac{1}{2}}+\frac{1}{2}\frac{\Delta t}{\Delta x}(F(\mathbf{U}^{n,+}_{j-\frac{1}{2}})-F(\mathbf{U}^{n,-}_{j+\frac{1}{2}})),
%\end{equation}
%\begin{equation}\label{nonequilibrium_hyperbolic_half_timestep2}
%{\mathbf{U}}^{n+\frac{1}{2},-}_{j+\frac{1}{2}}={\mathbf{U}}^{n,-}_{j+\frac{1}{2}}+\frac{1}{2}\frac{\Delta t}{\Delta x}(F(\mathbf{U}^{n,+}_{j-\frac{1}{2}})-F(\mathbf{U}^{n,-}_{j+\frac{1}{2}})),
%\end{equation}
%估计半个时间步~$\frac{\triangle t}{2}$ 上~$\mathbf{U}^{n+\frac{1}{2},+}_{j-\frac{1}{2}}$, $\mathbf{U}^{n+\frac{1}{2},-}_{j+\frac{1}{2}}$ 的值。
%\textbf{第三步}：
然后，对于该系统~(\ref{nonequilibrium_hyperbolic}) 初值为~${U}_L={{\mathbf{U}}}^{n+\frac{1}{2},-}_{j+\frac{1}{2}}$ 和 ~${U}_R={\mathbf{U}}^{n+\frac{1}{2},+}_{j+\frac{1}{2}}$ 的黎曼问题，通过修正的~HLLC 近似黎曼解法器计算得到界面的通量。
%\textbf{第四步}：
最后，通过~(\ref{nonequilibrium_conservation_scheme}) 式更新守恒变量的值，
\begin{equation}\label{nonequilibrium_hyperbolic_mid_value}
  \mathbf{U}^{mid}=\left\{
    \begin{array}{llll}
    \rho^{n+1}_j\\
    (\rho u)^{n+1}_j\\
    E^{*mid}_j\\
    {S_r}^{mid}_j\\
    \end{array}
    \right\}.
    \end{equation}
注意到这里得到的守恒变量只是中间值，接下来需要经过计算系统~(\ref{nonequilibrium_model}) 的扩散部分~(\ref{nonequilibrium_heat_transfer}) 来更新总的能量密度。

\BiSubsection{对于辐射扩散系统的隐式中心型有限体积格式}{An implicit centered finite volume scheme for the heat transfer}
在这一节中，首先介绍了求解辐射扩散系统~(\ref{nonequilibrium_heat_transfer}) 的隐式中心型有限体积方法。然后，利用~Newton-BiCGSTAB 算法求解该格式中关于~$T_j$ 的非线性函数。
\BiSubsubsection{非平衡扩散极限下辐射流体力学模型中的热传导方程}{The heat transfer in the equilibrium diffusion system}
非平衡扩散极限下辐射流体力学模型中的扩散部分为
\begin{equation}\label{nonequilibrium_heat_transfer2}
\left\{
\begin{array}{lll}
 \partial_t&\rho=0,\vspace{1ex}\\
 \partial_t&(\rho {u})=0,\vspace{1ex}\\
 \partial_t&(\rho E^*)=\mathcal{P}_0\partial_x(\kappa(\rho,T)\partial_x E_r),\vspace{1ex}\\
 \partial_t&{S_r}=\frac{3}{4T_r}(\partial_x(\kappa(\rho,T)\partial_xE_r)+\sigma(T^4-E_r)).\vspace{1ex}
\end{array}
\right.
\end{equation}
下面对上式进行简化。首先将系统~(\ref{nonequilibrium_heat_transfer2}) 中的第四个方程写作，
\begin{equation}\label{nonequilibrium_rewrite4}
\partial_tE_r=\partial_x(\kappa(\rho,T)\partial_xE_r)+\sigma(T^4-E_r).
\end{equation}
利用能量关系式~$E^*=E+\frac{1}{\rho} \mathcal{P}_0 E_r$，$E=C_vT+\frac{u^2}{2}$，将系统~(\ref{nonequilibrium_heat_transfer2}) 的第三、第四个方程化简为
\begin{equation}\label{nonequilibrium_rewrite34}
\rho C_v\partial_tT=-\mathcal{P}_0\sigma(T^4-E_r).
\end{equation}
所以只需要数值求解系统~(\ref{nonequilibrium_rewrite4}) 和~(\ref{nonequilibrium_rewrite34})。

采用隐式数值求解方法，
\begin{equation}\label{nonequilibrium_scheme}
\left\{
\begin{array}{lll}
\rho^n_j C_v \frac{T^{n+1}_j-T^n_j}{\Delta t}=-\mathcal{P}_0\sigma^n_j((T^{n+1}_j)^4-{E_{r}}_j^{n+1}),\vspace{1ex}\\
\frac{{E_r}_j^{n+1}-{E_r}_j^{n}}{\Delta t}-\frac{\kappa^n_{j+\frac{1}{2}}({E_r}_{j+1}^{n+1}-{E_r}_j^{n+1})-\kappa^n_{j-\frac{1}{2}}({E_r}_j^{n+1}-{E_r}_{j-1}^{n+1})}{(\Delta x)^2}=\sigma^n_j((T^{n+1}_j)^4-{E_r}_j^{n+1})\vspace{1ex},
\end{array}
\right.
\end{equation}
其中~$\kappa^n_{j+\frac{1}{2}}=\frac{2}{\frac{1}{\kappa^n_j}+\frac{1}{\kappa^n_{j+1}}}$.
类似于上节的介绍，将更新得到的变量将作为双曲系统~(\ref{nonequilibrium_hyperbolic}) 的初始值进行计算进入下一个时间步迭代。

\BiSection{数值实验}{Numerical experments}
$\textbf{例}~\mathbf{3.1}~$
第一个算例用来展示~MUSCL-Hancock 方法求解双曲系统~(\ref{nonequilibrium_hyperbolic}) 的表现。
本例中，取初始值为
\begin{equation*}
(\rho,u,p,T_r)(x,0)=
\left\{
\begin{array}{ll}
(1,0,1,1),~~~x\leq0.5,\\
(0.125,0,0.1,0.1),~~~~x>0.5.\\
\end{array}
\right.
\end{equation*}
那么该黎曼问题的解将会包含一个稀疏波，一个接触间断和一个激波。算例中参考解是在~2000 个网格上得到的解。通过图~\ref{golfer1}，可以看出该格式在光滑区域与参考解拟合的很好。对于该双曲系统，穿过激波面，所有的变量均是间断的，该计算格式在激波部分也是表现优异。并且穿过激波，$\frac{S_r}{\rho}$ 是连续的，这与该模型的理论相符合。

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath ex1}
\bicaption[golfer1]{}{时间~t=0.1 时刻，密度、流体速度、总压力和~$\frac{S_r}{\rho}$ 在~200 个网格上的解，其中辐射参数~$\mathcal{P}_0=1$}{Fig.$\!$}{A shock-tube problem. The solutions of density, fluid velocity, total pressure and $\frac{S_r}{\rho}$ on 200 mesh cells at t=0.1. The radiation
coefficient $\mathcal{P}_0$ is 1.}\vspace{-1em}
\end{figure}

$\textbf{例}~\mathbf{3.2}~$
下面，将数值实验与文献~\cite{2008Radiative} 中非平衡扩散极限下灰度辐射流体力学模型激波解的理论进行对比，并展现与平衡扩散极限下辐射流体力学模型激波解的不同。
辐射系数~$\mathcal{P}_0$ 和非线性热扩散~$\kappa$ 分别取值为~$10^{-4}$，1。
初始条件左状态~$(\rho_0,T_0,T_{r0},u_0)$ 为~$(1,1,1,\tilde{u}_0)$。
右状态~$(\rho_1,T_1,T_{r1},u_1)$ 通过以下~Rakine-Hugonit 跳跃条件的关系式得到，
\begin{equation}\label{nonequilibrium_RH}
\begin{array}{lll}
(\rho u)_0&=(\rho u)_1, \vspace{1ex}\\
(\rho u^2+p^*)_0&=(\rho u^2+p^*)_1, \vspace{1ex}\\
((E^*+p^*)u)_0&=((E^*+p^*)u)_1. \vspace{1ex}
\end{array}
\end{equation}

图~\ref{COMSHOCK_105_1d}-\ref{COMSHOCK_3_1d} 中展现了零扩散极限下辐射流体力学方程组的激波结构。其中穿越激波，其密度、物质温度都是间断的。而由于平衡扩散极限和非平衡扩散极限下灰度辐射流体力学模型扩散项的作用，密度和物质温度的行为将可能发生变化。接下来，通过数值实验将呈现平衡扩散极限和非平衡扩散极限下灰度辐射流体力学模型激波的结构。

在接下来的算例中，将取不同的~$\tilde{u}_0$ 值进行测试。

在图~\ref{COMSHOCK_105_1d} 中，展现了~$\tilde{u}_0=1.05$ 的平衡扩散极限和非平衡扩散极限下灰度辐射流体力学模型激波的结构。在该条件下，对于平衡扩散极限下的辐射流体力学模型来说，密度和温度是连续的。而对于非平衡扩散极限下灰度辐射流体力学模型，并没有嵌入流体激波，也不存在等温的声速点。穿过该模型的激波，密度、流体温度、辐射温度都是保持连续的。

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath COMSHOCK_105}
\bicaption[COMSHOCK_105_1d]{}{$\tilde{u}_0=1.05$ 条件下密度、物质温度、辐射温度在~200 个网格上的解。}{Fig.$\!$}{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.05$ on 200 mesh cells.}\vspace{-1em}
\end{figure}
%\begin{figure}[H]
%  \centering
%  \includegraphics[width=12cm,height=6cm]{COMSHOCK_12.png}
%  \caption{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.2$ on 200 mesh cells.}\label{Fig4}
%\end{figure}

图~\ref{COMSHOCK_12_1d} 中呈现了~$\tilde{u}_0=1.2$ 时的平衡扩散极限和非平衡扩散极限下灰度辐射流体力学模型激波的结构。在该条件下，平衡扩散极限下的辐射流体力学模型的激波结构中没有等温的激波存在，即~$\rho_p=\rho_1$。 穿过该激波，密度和温度是连续的。对于非平衡扩散极限下的灰度辐射流体力学模型来说，辐射温度是连续的。从图中可以看到有流体激波嵌入，其密度和物质温度是间断的。但并不存在等温的声速点，对于流体温度有~$T_s<T_1$，并且最大的物质温度不会大于温度~$T_1$.

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath COMSHOCK_12}
\bicaption[COMSHOCK_12_1d]{}{$\tilde{u}_0=1.2$ 条件下密度、物质温度、辐射温度在~200 个网格上的解。}{Fig.$\!$}{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.2$ on 200 mesh cells.}\vspace{-1em}
\end{figure}

图~\ref{COMSHOCK_14_1d} 中呈现了~$\tilde{u}_0=1.4$ 时的平衡扩散极限和非平衡扩散极限下灰度辐射流体力学模型激波的结构。在该条件下，平衡扩散极限下辐射流体力学模型的激波结构中存在等温的流体激波，物质温度是连续的、密度是间断的。对于非平衡扩散极限下的灰度辐射流体力学模型，辐射温度是连续的。该激波结构中有流体激波和等温的声速点存在，并且密度和物质温度均是间断的。在这种情况下，流体的最大温度在流体激波的波尾取得。

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath COMSHOCK_14}
\bicaption[COMSHOCK_14_1d]{}{$\tilde{u}_0=1.4$ 条件下密度、物质温度、辐射温度在~200 个网格上的解。}{Fig.$\!$}{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.4$ on 200 mesh cells.}\vspace{-1em}
\end{figure}

图~\ref{COMSHOCK_3_1d} 中呈现了~$\tilde{u}_0=3.0$ 时的平衡扩散极限和非平衡扩散极限下灰度辐射流体力学激波的结构。在该条件下，可以看出对于平衡扩散极限下的辐射流体力学模型的激波结构中有等温的流体激波嵌入，物质温度是连续的，但密度是间断的。而对于非平衡扩散极限下的灰度辐射流体力学模型，辐射温度是连续的，并且其激波中有流体激波和等温的声速点存在。在该条件下，从图中清晰的看到~Zel'dovich 飞跃，且流体温度的最大值~$T$ 要大于~$T_1$，密度和物质温度是间断的。

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath COMSHOCK_3}
\bicaption[COMSHOCK_3_1d]{}{$\tilde{u}_0=3.0$ 条件下密度、物质温度、辐射温度在~200 个网格上的解。}{Fig.$\!$}{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=3.0$ on 200 mesh cells.}\vspace{-1em}
\end{figure}

该格式的数值结果与文献~\cite{2008Radiative} 中的辐射流体力学模型激波理论是一致的。

接下来，将展现计算网格的大小对数值结果的影响。分别选取了网格数是~50，100，200 进行试验。从图~\ref{105_1d}-\ref{3_1d}，可以观测到网格大小对连续区域的影响较小。然而从图~\ref{3_1d} 中看到，200 个网格的激波结构比~50 个网格的激波结构更加的陡峭。由此可以看出，网格越精细越能更好追踪到激波的结构。

%\begin{figure}[H]
%  \centering
%  \includegraphics[width=12cm,height=6cm]{105.png}
%  \caption{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.05$.}\label{Fig1050}
%\end{figure}
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath 105}
\bicaption[105_1d]{}{$\tilde{u}_0=1.05$ 条件下密度、物质温度的解。}{Fig.$\!$}{A steady shock problem. The solutions of density and fluid temperature for $\tilde{u}_0=1.05$.}\vspace{-1em}
\end{figure}
%\begin{figure}[H]
%  \centering
%  \includegraphics[width=12cm,height=6cm]{12.png}
%  \caption{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.2$.}\label{Fig120}
%\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath 12}
\bicaption[12_1d]{}{$\tilde{u}_0=1.2$ 条件下密度、物质温度的解。}{Fig.$\!$}{A steady shock problem. The solutions of density and fluid temperature for $\tilde{u}_0=1.2$.}\vspace{-1em}
\end{figure}
%\begin{figure}[H]
%  \centering
%  \includegraphics[width=12cm,height=6cm]{14.png}
%  \caption{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=1.4$.}\label{Fig140}
%\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath 14}
\bicaption[14_1d]{}{$\tilde{u}_0=1.4$ 条件下密度、物质温度的解。}{Fig.$\!$}{A steady shock problem. The solutions of density and fluid temperature for $\tilde{u}_0=1.4$.}\vspace{-1em}
\end{figure}

%\begin{figure}[H]
%  \centering
%  \includegraphics[width=12cm,height=6cm]{3.png}
%  \caption{A steady shock problem. The solutions of density, fluid temperature and the radiative temperature for $\tilde{u}_0=3.0$.}\label{Fig30}
%\end{figure}
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{\fpath 3}
\bicaption[3_1d]{}{$\tilde{u}_0=3.0$ 条件下密度、物质温度的解。}{Fig.$\!$}{A steady shock problem. The solutions of density and fluid temperature for $\tilde{u}_0=3.0$.}\vspace{-1em}
\end{figure}

\BiSection{小结}{}
本节，针对非平衡扩散极限下的灰度辐射流体力学模型，设计了显隐格式求解算法。引入了辐射熵的公式，相比于传统的直接采用算子分裂的算法，在每个时间步上将少计算一个非线性方程组。同时通过数值实验与辐射流体力学模型激波解的理论一致验证了该算法的有效性。在下一节中，将该算法推广到二维辐射流体力学模型中。


